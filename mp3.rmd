---
title: 'Mini Project #3'
author: "Vivian Wang, Maggie Wang"
date: "November 13, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(mdsr)
library(RMySQL)
db <- dbConnect_scidb(dbname = "imdb")
db %>%
  dbGetQuery("SELECT * FROM kind_type;")
```

```{r}
mostsequels_sql <- "
SELECT t.title, t.id,
	COUNT(DISTINCT linked_movie_id) AS num_followers
FROM title t
JOIN movie_link ml ON ml.movie_id = t.id
JOIN movie_info mi ON mi.movie_id = t.id
JOIN movie_info mi2 ON mi2.movie_id = t.id
WHERE t.kind_id = 1
AND ml.link_type_id = 2
AND mi.info_type_id = 1
AND mi.info > 80
AND mi2.info_type_id = 8
AND mi2.info LIKE '%USA%'
GROUP BY t.title
ORDER BY num_followers DESC;
"

db %>% 
  dbGetQuery(mostsequels_sql)
```

```{r}
#are sequels/remakes/reboots more common now than before? is the duration between the original and sequel longer or shorter than they used to be?
```

