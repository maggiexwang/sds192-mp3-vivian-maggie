---
title: 'Mini Project #3'
author: "Vivian Wang, Maggie Wang"
date: "November 13, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(mdsr)
library(RMySQL)
library(dplyr)
db <- dbConnect_scidb(dbname = "imdb")
db %>%
  dbGetQuery("SELECT * FROM kind_type;")
```

```{r}
mostsequels_sql <- "
SELECT t.title, t.id, t.production_year AS year, 
  ml.linked_movie_id, 
  COUNT(DISTINCT linked_movie_id) AS num_sequels, 
	mi3.info AS genre
FROM title t
JOIN movie_link ml ON ml.movie_id = t.id
JOIN movie_info mi ON mi.movie_id = ml.linked_movie_id
JOIN movie_info mi2 ON mi2.movie_id = ml.linked_movie_id
JOIN movie_info mi3 ON mi3.movie_id = t.id
WHERE t.kind_id = 1
AND ml.link_type_id = 2
AND mi.info_type_id = 1
AND mi.info > 80
AND mi2.info_type_id = 8
AND mi2.info LIKE '%USA%'
AND mi3.info_type_id = 3
AND mi3.info <> 'Adult'
GROUP BY t.title
ORDER BY num_sequels DESC;
"

mostsequels <- db %>% 
  dbGetQuery(mostsequels_sql) %>% 
  select(title, id, year, num_sequels)
```

```{r}
#are sequels/remakes/reboots more common now than before? is the duration between the original and sequel longer or shorter than they used to be?
```

